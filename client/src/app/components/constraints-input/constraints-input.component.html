<form>
    <div class="container form-root">
        <div class="row">
            <div class="properties-head">
                <div data-toggle="tooltip" data-placement="bottom" title="How many actors do you need">
                    <label class="sr-only" for="actors">Actors</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                            <div class="input-group-text">
                                <svg class="bi bi-people-fill" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 100-6 3 3 0 000 6zm-5.784 6A2.238 2.238 0 015 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 005 9c-4 0-5 3-5 4s1 1 1 1h4.216zM4.5 8a2.5 2.5 0 100-5 2.5 2.5 0 000 5z" clip-rule="evenodd"/>
                                </svg>
                            </div>
                            </div>
                            <input type="number" class="form-control" name="actors" min="1" max="30" step="1" value="5" size="2"(change)="change_actors($event)">
                        </div>
                </div>
                <div data-toggle="tooltip" data-placement="bottom" title="How many scenes will be filmed">
                    <label class="sr-only" for="actors">Scenes</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                            <div class="input-group-text">
                                <svg class="bi bi-film" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M0 1a1 1 0 011-1h14a1 1 0 011 1v14a1 1 0 01-1 1H1a1 1 0 01-1-1V1zm4 0h8v6H4V1zm8 8H4v6h8V9zM1 1h2v2H1V1zm2 3H1v2h2V4zM1 7h2v2H1V7zm2 3H1v2h2v-2zm-2 3h2v2H1v-2zM15 1h-2v2h2V1zm-2 3h2v2h-2V4zm2 3h-2v2h2V7zm-2 3h2v2h-2v-2zm2 3h-2v2h2v-2z" clip-rule="evenodd"/>
                                  </svg>
                            </div>
                            </div>
                            <input type="number" class="form-control" name="scenes" min="1" max="30" step="1" value="5" size="2"(change)="change_scenes($event)">
                        </div>
                </div>

                <div class="checkbox" data-toggle="tooltip" data-placement="bottom" title="Check if you want to use actor availability and actor dislikes">
                    <input name="complex" type="checkbox" [(ngModel)]="complex" class="check" /><label for="complex">C</label>
                </div>
                <!--
                <input name="options" ng-control="options" type="radio" [value]="true"  [(ngModel)]="complex" >
                <input name="options" ng-control="options" type="radio" [value]="false" [(ngModel)]="complex" >
                -->
            </div>
        </div>

        <!-- Scenes actors participate in -->
        <div class="row constraints">
            <div class="sd">
                <h3>
                    Scenes Length
                </h3>
                <div class="sd-input-group" *ngFor="let scene of scenes_length; let s = index; trackBy: trackByIndex">
                    <label class="sr-only" for="sd_{{s}}">sd{{s}}</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                        <div class="input-group-text">
                            {{s + 1}}
                        </div>
                        </div>
                        <input type="number" class="form-control no-arrows" name="sd_{{s}}" placeholder="1" [(ngModel)]="scenes_length[s]" min="1" size="3  ">
                    </div>
                </div>
            </div>
            <div class="fields">
                <div class="form-row sticky-container" *ngFor="let actor of scenes_actors; let a = index; trackBy: trackByIndex">
                    <div class="col actor">
                        <input [(ngModel)]="actor.name" type="text" name="name_{{ a }}" placeholder="Actor Name" class="form-control" autofocus />
                    </div>
                    <div class="col prop">
                        <label class="sr-only" for="p_{{a}}_p">Payment</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                            <div class="input-group-text">
                                <svg class="bi bi-gem" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M3.1.7a.5.5 0 01.4-.2h9a.5.5 0 01.4.2l2.976 3.974c.149.185.156.45.01.644L8.4 15.3a.5.5 0 01-.8 0L.1 5.3a.5.5 0 010-.6l3-4zm11.386 3.785l-1.806-2.41-.776 2.413 2.582-.003zm-3.633.004l.961-2.989H4.186l.963 2.995 5.704-.006zM5.47 5.495l5.062-.005L8 13.366 5.47 5.495zm-1.371-.999l-.78-2.422-1.818 2.425 2.598-.003zM1.499 5.5l2.92-.003 2.193 6.82L1.5 5.5zm7.889 6.817l2.194-6.828 2.929-.003-5.123 6.831z" clip-rule="evenodd"/>
                                </svg>
                            </div>
                            </div>
                            <input type="number" class="form-control no-arrows" name="p_{{a}}_p" placeholder="1" [(ngModel)]="scenes_actors[a].payment" min="1" size="6">
                        </div>
                    </div>
                    <div *ngIf="complex" class="col prop">
                        <label class="sr-only" for="p_{{a}}_a">Availability</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                <div class="input-group-text">
                                    <svg class="bi bi-alarm" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M8 15A6 6 0 108 3a6 6 0 000 12zm0 1A7 7 0 108 2a7 7 0 000 14z" clip-rule="evenodd"/>
                                        <path fill-rule="evenodd" d="M8 4.5a.5.5 0 01.5.5v4a.5.5 0 01-.053.224l-1.5 3a.5.5 0 11-.894-.448L7.5 8.882V5a.5.5 0 01.5-.5z" clip-rule="evenodd"/>
                                        <path d="M.86 5.387A2.5 2.5 0 114.387 1.86 8.035 8.035 0 00.86 5.387zM11.613 1.86a2.5 2.5 0 113.527 3.527 8.035 8.035 0 00-3.527-3.527z"/>
                                        <path fill-rule="evenodd" d="M11.646 14.146a.5.5 0 01.708 0l1 1a.5.5 0 01-.708.708l-1-1a.5.5 0 010-.708zm-7.292 0a.5.5 0 00-.708 0l-1 1a.5.5 0 00.708.708l1-1a.5.5 0 000-.708zM5.5.5A.5.5 0 016 0h4a.5.5 0 010 1H6a.5.5 0 01-.5-.5z" clip-rule="evenodd"/>
                                        <path d="M7 1h2v2H7V1z"/>
                                    </svg>
                                </div>
                                </div>
                                <input type="number" class="form-control no-arrows" name="p_{{a}}_a" placeholder="0" [(ngModel)]="scenes_actors[a].availability" min="0" size="6">
                            </div>
                    </div>
                    <div class="col scenes" *ngFor="let scene of actor.scenes; let s = index; trackBy: trackByIndex">
                        <div class="checkbox">
                            <input name="{{ a }}_{{ s }}" type="checkbox" [(ngModel)]="scenes_actors[a].scenes[s]" class="check" /><label for="{{ a }}_{{ s }}">{{ s + 1 }}</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Who dislikes who -->
        <ng-container *ngIf="complex">
        <div class="row dislikes">
            <svg class="bi bi-exclamation-square-fill mid-icon" style="align-self:center;" width="2em" height="2em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M2 0a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2H2zm6 4a.905.905 0 00-.9.995l.35 3.507a.552.552 0 001.1 0l.35-3.507A.905.905 0 008 4zm.002 6a1 1 0 100 2 1 1 0 000-2z" clip-rule="evenodd"/>
            </svg>
            <div class="form-row" *ngFor="let pair of dislikes; let p = index; trackBy: trackByIndex">
                <select class="form-control col-md-5 col-sm-5 col-5" name="d_{{p}}_0" [(ngModel)]="dislikes[p][0]">
                    <option value="undefined">This person dislikes</option>
                    <ng-container *ngFor="let actor of scenes_actors">
                        <option *ngIf="actor.name !== dislikes[p][1]">{{actor.name}}</option>
                    </ng-container>
                </select>
                <select class="form-control offset-md-2 offset-2 col-md-5 col-sm-5 col-5" name="d_{{p}}_1" [(ngModel)]="dislikes[p][1]">
                    <option value="undefined">this other person</option>
                    <ng-container *ngFor="let actor of scenes_actors">
                        <option *ngIf="actor.name !== dislikes[p][0]">{{actor.name}}</option>
                    </ng-container>
                </select>
            </div>
        </div>
        <div class="form-row">
            <button class="btn btn-success offset-md-1 offset-1 col-md-3 col-4" (click)="more_dislikes()">
                <svg class="bi bi-plus-circle" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M8 3.5a.5.5 0 01.5.5v4a.5.5 0 01-.5.5H4a.5.5 0 010-1h3.5V4a.5.5 0 01.5-.5z" clip-rule="evenodd"/>
                <path fill-rule="evenodd" d="M7.5 8a.5.5 0 01.5-.5h4a.5.5 0 010 1H8.5V12a.5.5 0 01-1 0V8z" clip-rule="evenodd"/>
                <path fill-rule="evenodd" d="M8 15A7 7 0 108 1a7 7 0 000 14zm0 1A8 8 0 108 0a8 8 0 000 16z" clip-rule="evenodd"/>
              </svg>
            </button>
            <button class="btn btn-danger offset-md-4 offset-2 col-md-3 col-4" (click)="less_dislikes()">
                <svg class="bi bi-x-circle" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M8 15A7 7 0 108 1a7 7 0 000 14zm0 1A8 8 0 108 0a8 8 0 000 16z" clip-rule="evenodd"/>
                    <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                    <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
              </svg>
            </button>
        </div>
        </ng-container>
    </div>
    <div class="row m-2">
        <button (click)="submit()" class="btn btn-primary btn-block">
            Try me
        </button>
        <button type="button" class="btn btn-secondary btn-block" data-toggle="modal" data-target="#stringModal">
            Input your string
        </button>
    </div>
</form>

<div class="modal" id="solvingModal" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="solvingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="solvingModalLabel">Finding a solution...</h5>
          <!--
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          -->
        </div>
        <div class="modal-body">
            <p>
                At this time, your problem is running on a constraint solver. We'll show you an answer when it is done.
            </p>
            <p>
                This is the input string:
            </p>
            <textarea rows="12" disabled>{{ inputString }}</textarea>
            <div class="spinner-grow mx-auto" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
        <!--
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Understood</button>
        </div>
        -->
        </div>
    </div>
</div>
  
<!-- Modal -->
<div class="modal fade" id="stringModal" tabindex="-1" role="dialog" aria-labelledby="stringModalLabel"aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="stringModalLabel">Paste your input</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <textarea rows="12" [(ngModel)]="inputString"></textarea>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" (click)="submitString()">Submit</button>
      </div>
    </div>
  </div>
</div>
